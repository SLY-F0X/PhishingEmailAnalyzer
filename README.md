# «Анализатор фишинговых сообщений»

## Общие сведения о программе
Программа «Анализатор фишинговых сообщений» предназначена для обнаружения и фильтрации фишинговых сообщений в электронной почте
Функциональным назначением программного средства является обнаружение и фильтрация фишинговых сообщений с помощью нейросети в указанной папке на сервере электронной почты, с уведомлением пользователя о количестве найденных и отфильтрованных сообщений

## Программа состоит из следующих компонентов:
* Модуля основной логики, отвечающего за взаимодействие с почтовым сервером по протоколу IMAP, сбору данных о папках и письмах, предобработки текста писем, классификации с использованием нейронной сети и функции фильтрации фишинговых писем, а также передачи данных в графический интерфейс.
* Модуля графического интерфейса.
* Модуля, обеспечивающего предсказание нейросетью, содержащего в себе метод предобработки входных данных и дополнительной классификации методом случайного леса.
* Модулей для анализа файлов и ссылок для отдельного взятого письма и получения отчёта о найденных угрозах.

## Настройка программы
Требуется стабильное подключение к сети Интернет. 
Необходимо настроить параметры подключения к почтовому серверу, указав адрес сервера, логин и пароль пользователя.

## Установка необходимых зависимостей

    pip install customtkinter
    pip install email
    pip install numpy
    pip install matplotlib
    pip install beautifulsoup4 html5lib
    pip install spacy==3.7.0
    python -m spacy download ru_core_news_md
    pip install joblib
    pip install torch
    pip install scikit-learn==1.4.2

## Выполнение программы
* При запуске программы необходимо, выбрать или ввести IMAP сервер, вписать логин и пароль от почтового сервера, нажать кнопку "Войти". 
* Загружается список папок, необходимо выбрать папку и нажать "Выбор папки", в результате появится список всех писем в выбранной директории.
* Для обнаружения и фильтрации фишинга необходимо выбрать целевую папку с письмами и нажать кнопку "Анализ и фильтрация фишинговых писем в выбранной папке".
* Запустится анализ и фильтрация писем, после завершения анализа, выведется окно о количестве отфильтрованных фишинговых писем.
* Если необходимо провести более детальный анализ отдельного письма, его необходимо загрузить, нажав на кнопку "Загрузить письмо", для предпросмотра и уже в новом окне запустить отдельно анализ файлов и ссылок, который в конечном счёте учитывается при классификации категории письма. 
* После нажатия на кнопку "Проанализировать и отфильтровать письмо", появится окно "Анализ письма" с отображением статистики и вероятности 
фишинга.
* В случае обнаружения фишинга письмо автоматически фильтруется в специальную папку "FilteredPhishing" создаваемую на почтовом сервере, в случае её отсутствия.
